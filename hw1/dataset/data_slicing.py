# change the format of dataset generated by IBMGenerator
# procedure:
# 1. turn space to comma
# 2. remove first three attributes (row_id, trasaction_id & num_items)

import re
import sys

input_path = sys.argv[1]
output_path = sys.argv[2]

with open(input_path) as input_file, \
     open(output_path, mode='w') as output_file:
  print("read input file: ", input_path)
  for line in input_file:
    output_line = line.replace(' ', ',')
    output_line = re.sub('^[0-9]*,[0-9]*,[0-9]*,', '', output_line)
    # print(output_line)
    output_file.write(output_line)

print("write output file: ", output_path)